---
layout: post
title: "FBProphet"
published: false
categories: [ml, time_series]
---
# [FBProphet](https://facebook.github.io/prophet/)
> Prophet is a procedure for **forecasting time series data based on an additive model** where non-linear trends are fit with yearly, weekly, and daily seasonality, plus holiday effects. It **works best** with time series that have **strong seasonal effects** and several seasons of historical data. Prophet is **robust to missing data and shifts in the trend**, and typically handles outliers well.



### [Trend Changepoints](https://facebook.github.io/prophet/docs/trend_changepoints.html)
> By default, Prophet will automatically detect these changepoints and will allow the trend to adapt appropriately.
However, if you wish to have finer control over this process, then there are several input arguments you can use.

#### Automatic changepoint detection in Prophet
> Prophet detects changepoints by first specifying a large number of potential changepoints at which the rate is allowed to change.

```Python
# Python
from fbprophet.plot import add_changepoints_to_plot
fig = m.plot(forecast)
a = add_changepoints_to_plot(fig.gca(), m, forecast)
```

* By default, Prophet specifies **25 potential changepoints**
* By default **changepoints** are only inferred for the first 80% of the time series
* We have a lot of places where the rate can possibly change
* Most of these changepoints go unused
* `n_changepoints`  set number of potential changepoints, but this is better tuned by adjusting the regularization.
* `changepoint_range`   For example, `m = Prophet(changepoint_range=0.9)` in Python

#### Adjusting trend flexibility
> If the trend changes are being overfit (too much flexibility) or underfit (not enough flexibility), you can adjust the strength of the sparse prior using the input argument changepoint_prior_scale. **Increasing** it will make the trend **more** flexible:

```Python
# Python
m = Prophet(changepoint_prior_scale=0.5)
forecast = m.fit(df).predict(future)
fig = m.plot(forecast)
```

### [Seasonality, Holiday Effects, And Regressors](https://facebook.github.io/prophet/docs/seasonality,_holiday_effects,_and_regressors.html)

#### Built-in Country Holidays
> You can use a built-in collection of country-specific holidays using the `add_country_holidays` method

```Python
# Python
m = Prophet(holidays=holidays)
m.add_country_holidays(country_name='US')
m.fit(df)
```
